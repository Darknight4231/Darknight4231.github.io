<!DOCTYPE html>
<head>
  <title>Drawing Application</title>
  <style>

  body{
    font-family: sans-serif;
  }
  #canvas1{
    float: left;
    outline: solid 1px black;
    position: relative;
  }
  #colorcanv{
    outline: solid 1px black;
    clear: left;
    position: relative;
  }

  #BrushSize{
    clear: left;
    float: left;
    outline: solid 2px black;
    padding: 1em;
  }


  #colors>input, label{
    margin-top: 2em;
    padding: 1em;
    float: left;
  }

  .Red{
    outline: solid 2px red;
    background-color: red;
  }
  #Red{
    clear: left;
  }
  .Green{
    outline: solid 2px green;
    background-color: green;
  }
  #Green{

  }
  .Blue{
    outline: solid 2px blue;
    background-color: blue;
  }
  #Blue{
    
  }


  </style>
</head>
<body>

<canvas id="canvas1"><p>Your browser doesn't support canvas API, use a browser that supports HTML5 standards.</p></canvas>
<canvas id="colorcanv"><p>Same as above, use a browser that supports canvas API and HTML5 standards.</p></canvas>

  <div id="colors">
    <input type="range" id="Red" class="Red" name="Red" min="0" max="255"><label class="Red" for="Red">Red color</label>
    <input type="range" id="Green" class="Green" name="Green" min="0" max="255"><label class="Green" for="Green">Green color</label>
    <input type="range" id="Blue" class="Blue" name="Blue" min="0" max="255"><label class="Blue" for="Blue">Blue color</label>
  </div>

    <input type="range" id="BrushSize" name="BrushSize"><label for="BrushSize">BrushSize</label>
    <p>This box shows the size and color with the current brush settings. <i>Minus the outline of course</i></p>
    <button type="button" id="Clearbutton" name="button">Clear Canvas</button>

  <script>

  //BrushSize.
  let BrushSize = document.getElementById("BrushSize").value;

  const canvas = document.getElementById("canvas1");
  const ctx = canvas.getContext("2d");
  let cramw = canvas.width = 800;
  let cramh = canvas.height = 600;

  const colorcanv = document.getElementById("colorcanv");
  const ctxcol = colorcanv.getContext("2d");
  let colcanvw = colorcanv.width = BrushSize;
  let colcanvh = colorcanv.height = BrushSize;

  //Red Green and blue inputs.
  let Red = document.getElementById("Red").value;
  let Green = document.getElementById("Green").value;
  let Blue = document.getElementById("Blue").value;


  //array to store X and Y value of pointer.
  let ClickLoc = [];
  let mousedown = false;
  let moved = false;

  canvas.addEventListener("mousedown",click);
  canvas.addEventListener("mousemove", move);
  canvas.addEventListener("mouseup",unclick);
  //update mouse pointer on click
  function click(e){
    ClickLoc[0] = e.clientX-canvas.offsetLeft-BrushSize/2;
    ClickLoc[1] = e.clientY-canvas.offsetTop-BrushSize/2;
    console.log("clicked");
    mousedown = true;
    draw();
  };
  function move(e){
    if (mousedown){
    ClickLoc[0] = e.clientX-canvas.offsetLeft-BrushSize/2;
    ClickLoc[1] = e.clientY-canvas.offsetTop-BrushSize/2;
    console.log('Mousemoved');
    draw();
   }
  };
  function unclick(){
    mousedown = false;
    moved = false;
  };

  //Update all colors on one change.
  document.getElementById("colors").onchange = colorchange;

  function colorchange (){
    Red = document.getElementById("Red").value;
    Green = document.getElementById("Green").value;
    Blue = document.getElementById("Blue").value;
    ctxcol.beginPath();
    ctxcol.fillStyle = `rgb(${Red},${Green},${Blue})`;
    ctxcol.rect(0,0,BrushSize,BrushSize);
    ctxcol.fill();
    ctxcol.closePath();
    console.log("RGB values respectively. "+Red+" "+Green+" "+Blue);
  };

  //Update BrushSize on change.
  document.getElementById("BrushSize").onchange = function(){
    BrushSize = document.getElementById("BrushSize").value;
    console.log("BrushSize is now "+BrushSize);
    colorcanv.width = BrushSize;
    colorcanv.height = BrushSize;
    colorchange();
  };

  function draw(){
    if (mousedown || mousedown && moved) {
    ctx.beginPath();
    ctx.fillStyle = `rgb(${Red},${Green},${Blue})`;
    ctx.rect(ClickLoc[0],ClickLoc[1],BrushSize,BrushSize);
    ctx.fill();
    ctx.closePath();
    moved = false;}
  };

  document.getElementById("Clearbutton").onclick = function(){
    ctx.beginPath();
    ctx.fillStyle = 'white';
    ctx.rect(0,0,cramw,cramh);
    ctx.fill();
    ctx.closePath();
  }

  colorchange();


  </script>
</body>
